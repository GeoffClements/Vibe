name: Feature_Build

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    strategy:
      fail-fast: false
      matrix:
        feature:
          - ""
          - "notify"
          - "rodio"
          - "notify,rodio"
        no_default_features:
          - true
          - false

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Rust
      uses: actions-rs/toolchain@v1
      with:
        toolchain: stable
        override: true

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y pkg-config libpulse-dev libasound2-dev libdbus-1-dev

    - name: Build with feature(s)
      run: |
        if [ "${{ matrix.no_default_features }}" = true and ne("${{ matrix.feature }}", "")  and ne("${{ matrix.feature }}", "notify") ]; then
          cargo build --no-default-features --features "${{ matrix.feature }}"
        else
          cargo build --features "${{ matrix.feature }}"
        fi
